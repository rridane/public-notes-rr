= 🔐 Hashs cryptographiques & signatures numériques – Cheatsheet

:toc: left
:toclevels: 3
:numbered:
:source-highlighter: rouge

== Hash

.exemple hash sha256
[source,shell]
----
echo -n "hello" | sha256sum
# Résultat : 2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824
----

.mauvaises pratiques mot de passe
[source,text]
----
hash("password123") == hash("password123")
→ vulnérable aux rainbow tables
----

.bonne pratique avec salt
[source,text]
----
hash("password123" + salt)
→ rend les attaques pré-calculées inutiles
----

Utiliser des KDF comme :

* bcrypt
* scrypt
* argon2id (recommandé)

== 3️⃣ Signatures numériques ✍️

=== Étape 1 : Générer une paire de clés

[source,shell]
----
# Clé privée RSA 2048 bits
openssl genpkey -algorithm RSA -out private.pem -pkeyopt rsa_keygen_bits:2048

# Clé publique extraite
openssl rsa -pubout -in private.pem -out public.pem
----

.Fichier `private.pem` (extrait)
[source, text]
----
-----BEGIN PRIVATE KEY-----
MIIEvAIBADANBgkqhkiG9w0BAQEFAASC...
...
-----END PRIVATE KEY-----
----

.Fichier `public.pem` (extrait)
[source, text]
----
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A...
...
-----END PUBLIC KEY-----
----

=== Étape 2 : Créer un fichier à signer

[source,shell]
----
echo "message à signer" > message.txt
----

.Contenu de `message.txt`
[source, text]
----
message à signer
----

=== Étape 3 : Calculer le hash (optionnel)

[source,shell]
----
openssl dgst -sha256 message.txt
----

.Sortie
[source,text]
----
SHA256(message.txt)= 7da95fb20b36743ab6bd3be5cc49f71ee350aaf62e78f04b650cf3a9de7cc11e
----

→ Il s’agit du **hash SHA-256** du contenu `message à signer`.

=== Étape 4 : Signer le fichier (signature binaire)

[source,shell]
----
openssl dgst -sha256 -sign private.pem -out message.sig message.txt
----

→ Le fichier `message.sig` contient une **signature binaire RSA** du hash précédent.

Pour le rendre lisible :

[source,shell]
----
base64 message.sig
----

.Exemple (résultat base64 de la signature)
[source,text]
----
GRe4eIfRQQcsKMm8c+1GIdLr2c2q6L4qFzA3YH2w0LGphDj/oxYMoK8DJf+EZV3RGZQg...
----

=== Étape 5 : Vérifier la signature

[source,shell]
----
openssl dgst -sha256 -verify public.pem -signature message.sig message.txt
----

.Sortie attendue
[source,text]
----
Verified OK
----

* `openssl dgst`
* `sha256sum`, `blake3sum`
* `gpg --sign`, `gpg --verify`
